if (self.CavalryLogger) { CavalryLogger.start_js(["lWXVP"]); }

__d("MWChatTabContainerCommon.bs",["requireCond","cr:1663108"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1663108").make;f.$MWChatTabContainer$OR$MWChatTabContainer_DEPRECATED$requireCond=b("cr:1663108");f.make=a}),null);
__d("MWChatTabContainer_DEPRECATED.bs",["fbt","bs_block","bs_curry","React","gkx","bs_js_dict","MWTheme.bs","qex","bs_caml_obj","BanzaiODS","MWUITheme.bs","bs_caml_array","JSResource","MercuryIDs","stylex","bs_belt_Option","bs_caml_format","bs_caml_option","CurrentUser","requireCond","UserActivity","MWChatBlurTab.bs","MWChatOpenTab.bs","MWChatCloseTab.bs","MWChatFocusTab.bs","MWUILeaveGroup.bs","MWUIThreadName.bs","CometLink.react","MWUIBlockStatus.bs","MWUIDeleteThread.bs","MWUIThreadFolder.bs","bs_js_null_undefined","MWChatCollapseTab.bs","MessengerWebEvent","BootloaderResource","MWUIChatThreadHook.bs","MWUIInThreadBanner.bs","MWUIStartPhoneCall.bs","MWChatHasTabContent.bs","MWThread_DEPRECATED.bs","MWUILoadThreadTitle.bs","MWUISendTextMessage.bs","MWUIThreadHasThread.bs","MWUILoadParticipants.bs","MWUIMarkThreadAsRead.bs","MWUIRTCDisplayStatus.bs","MWUIRepliedToMessage.bs","MWUIWebUrlCtaHandler.bs","recoverableViolation","MWUIChatContextBanner.bs","MWUIFetchMessagesPage.bs","MWUILoadThreadPicture.bs","MWUISendCometPostback.bs","MWUIThreadProfileLink.bs","ZenonUserActionLogger","MWChatIsMessageRequest.bs","MWUIGetServerMessageID.bs","MWUILoadThreadMessages.bs","MWUIThreadHasLeftGroup.bs","MessengerWebEntryPoint","unrecoverableViolation","MWUIContactCapabilities.bs","MWChatTabContainerShared.bs","MWUIThreadReportingToken.bs","MWUIThreadHasMoreMessages.bs","CometHeroHoldTrigger.react","MWChatPollXMAActionHandler.bs","MWUIAddParticipantsToGroup.bs","MWUIPresenceIsThreadActive.bs","MWUIThreadMuteExpireTimeMs.bs","RTWebLoggingSurfaceConvert.bs","useCometConfirmationDialog","MWChatBlockMessagesMutation","MWChatConfirmTabCloseDialog.bs","MWChatTabGroupWarningPolicy.bs","CometLazyDialogTrigger.react","MWChatComposerViewStateStore.bs","MWUIThreadUnreadMessageCount.bs","RTWebLoggingComponentConvert.bs","MWChatBusinessPageSettingHook.bs","MWChatBusinessWelcomePageHook.bs","MWUIUpdateParticipantNickname.bs","MessengerWebStgTypedLoggerLite.bs","MWChatXmaThirdPartyActionHandler.bs","CometTransientDialogProvider.react","CometProgressRingIndeterminate.react","MWChatCalculateIsMutedFromExpireTime.bs","MWChatComposerMessageRequestInfoText.bs","MWUILoadIsDisabledComposerThreadLevel.bs","XCometMessengerMediaControllerRouteBuilder","XCometMessengerPhotoControllerRouteBuilder","cr:1375301","cr:1536325"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("React"),j=b("JSResource")("MWChatBusinessIcebreaker.bs").__setRef("MWChatTabContainer_DEPRECATED.bs");function aa(a,c,d,e,f,g){g={icebreakers:a,onSend:c,pageID:d,threadTitle:e};f!==void 0&&(g.showWarning=b("bs_caml_option").valFromOption(f));return g}function ba(a){return i.createElement(b("BootloaderResource").read(j).make,a)}function a(a){var c=a.isTabFocused,d=a.hasContent,e=a.isMultitab,f=a.useSidebarChatStyles,j=a.searchResultMessages;a=a.isMainRegion;e=e!==void 0?e:!1;j=j!==void 0?b("bs_caml_option").valFromOption(j):null;a=a!==void 0?a:!1;var k=i.useRef(!1),l=b("bs_curry")._1(b("MWUIMarkThreadAsRead.bs").useHook,0),m=b("bs_curry")._1(b("MWUIThreadReportingToken.bs").useHook,0),n=b("bs_curry")._1(b("MWUIThreadHasThread.bs").useHook,0),o=b("bs_curry")._1(b("MWUIThreadHasLeftGroup.bs").useHook,0),p=b("bs_curry")._1(b("MWUIThreadFolder.bs").useHook,0),q=b("bs_curry")._1(b("MWUIThreadUnreadMessageCount.bs").useHook,0),r=b("bs_curry")._1(b("MWUIThreadMuteExpireTimeMs.bs").useHook,0);r=b("MWChatCalculateIsMutedFromExpireTime.bs").useHook(r);var s=b("bs_curry")._1(b("MWUIThreadName.bs").useHook,0),t=[[246387948,b("bs_curry")._1(b("MWUILoadThreadMessages.bs").useMessageItems,0)]],u=b("bs_curry")._1(b("MWUIThreadHasMoreMessages.bs").useThreadHasMoreMessages,0),ca=b("bs_curry")._1(b("MWUIStartPhoneCall.bs").useMakeRTCCall,0),v=ca[0],da=b("bs_curry")._1(b("MWUIAddParticipantsToGroup.bs").useHook,0),w=i.useState(function(){return!1}),ea=w[1];i.useEffect(function(){c&&q>0&&b("UserActivity").isOnTab()&&b("UserActivity").isActive()&&b("bs_curry")._1(l,0);return},[c,q,l]);b("MWChatComposerViewStateStore.bs").useClearStore(0);var x=i.useRef(0),y=i.useRef(null),z=b("MWThread_DEPRECATED.bs").useIdExn(0),A;if(typeof z==="number")A=void 0;else{var B=z[0];A=B!==892012143&&B!==948354667?void 0:b("bs_caml_option").some(z[1])}b("bs_curry")._1(b("MWUIChatThreadHook.bs").useThread,z);B=b("bs_curry")._1(b("MWUILoadParticipants.bs").useMercuryParticipants,z);var fa=B[1];B=B[0];var ga=b("bs_curry")._1(b("MWUIFetchMessagesPage.bs").useFetchMessagesPage,0),C=b("bs_curry")._1(b("MWUIPresenceIsThreadActive.bs").useHook,0),D=b("bs_curry")._1(b("MWUIRepliedToMessage.bs").useCurrentlyRepliedToMessage,0),ha=D[2],ia=D[1];D=D[0];var ja=b("bs_curry")._1(b("MWUITheme.bs").useTheme,0),ka=function(a,c){c=a!==void 0?a:!1;a=x.current;if(typeof a==="number")if(c)return b("bs_curry")._1(ga,0);else return 0;else if(a.tag)return 0;else return b("bs_curry")._1(ga,0)},E=b("bs_curry")._1(b("MWUIBlockStatus.bs").useIsThreadBlocked,0),la=typeof z==="number"||z[0]!==757211935?!1:b("bs_js_dict").entries(B).some(function(a){return b("bs_caml_obj").caml_equal(a[1].id,b("MercuryIDs").getParticipantIDFromUserID(b("CurrentUser").getID()))}),F=b("bs_curry")._1(b("MWUILoadThreadPicture.bs").useHook,0),G=b("bs_curry")._1(b("MWUILoadThreadTitle.bs").useHook,0),ma=G[1];G=G[0];p=b("MWChatIsMessageRequest.bs").fn(p);var H=b("bs_curry")._1(b("MWUIThreadProfileLink.bs").useHook,0),I=z[0];if(I!==757211935)if(I!==892012143)if(G!==void 0&&F.length>0){I=b("bs_belt_Option").getWithDefault(s,"");var J=z[1],K=b("bs_caml_array").caml_array_get(F,0);I={title:G,rawTitle:I,actorID:J,href:H,profileImage:K};J=p?b("bs_block").__(1,[I]):b("bs_block").__(0,[I])}else J=1;else J=s!==void 0&&G!==void 0&&F.length>0?b("bs_block").__(2,[{title:G,rawTitle:s,actorID:z[1],href:H,profileImage:b("bs_caml_array").caml_array_get(F,0)}]):1;else if(w[0])J=0;else if(G!==void 0&&F.length>0){K=b("bs_belt_Option").getWithDefault(s,"");I={title:G,rawTitle:K,profileImages:F};J=p?b("bs_block").__(4,[I]):b("bs_block").__(3,[I])}else J=1;if(n){if(t.length!==1)H=!1;else{w=t[0];H=typeof w==="number"||w[0]!==246387948||w[1].length!==0?!1:u}if(t.length!==1)s=!1;else{K=t[0];s=typeof K==="number"||K[0]!==246387948||K[1].length!==0?!1:!u}if(typeof z==="number")p=[!0,H,!u,s];else{I=z[0];p=I!==757211935?I!==892012143?[!0,H,!u,s]:[!0,H,!u,s]:[!0,H,!u,s]}}else p=[!1,!0,!1,!0];n=p[3];w=p[1];K=b("bs_curry")._1(b("MWUIRTCDisplayStatus.bs").useHook,0);I=b("bs_curry")._3(b("MWUIChatContextBanner.bs").useContextBanner,z,F,p[2]);H=b("MWChatBusinessWelcomePageHook.bs").useMessengerBusinessWelcomePage(z,n);u=b("MWChatBusinessPageSettingHook.bs").useMessengerBusinessPageSetting(z,"STRUCTURED_MENU_ENABLED");s=b("bs_curry")._1(b("MWUILoadIsDisabledComposerThreadLevel.bs").useHook,z);F=b("MWChatBusinessPageSettingHook.bs").useMessengerBusinessPageSetting(z,"COMPOSER_INPUT_DISABLED");var L=b("gkx")("1277703"),M=b("gkx")("1612202")?4:0,N;if(E!==void 0){var O=E;if(typeof z==="number")N=M;else{var P=z[0];if(P!==757211935)if(P!==892012143)N=P!==948354667||!O?M:b("bs_block").__(0,[z[1],m]);else{P=s!==void 0?s:F;s=0;L&&O?N=b("bs_block").__(1,[z[1],m]):s=1;if(s===1)if(H!==void 0){F=b("bs_caml_option").valFromOption(H).null_state_cta;N=F!==void 0?b("bs_block").__(2,[b("bs_caml_option").valFromOption(F),G]):P===!0?1:M}else N=P?1:M}else N=o?2:M}}else N=3;L=b("MWChatHasTabContent.bs").useHook(0);var Q=b("MWChatCloseTab.bs").useHook(b("MessengerWebEntryPoint").UNKNOWN),R=b("MWChatCollapseTab.bs").useHook(b("MessengerWebEntryPoint").UNKNOWN),na=b("MWChatOpenTab.bs").useHook_DEPRECATED(b("MessengerWebEntryPoint").UNKNOWN),oa=b("MWChatFocusTab.bs").useHook(b("MessengerWebEntryPoint").UNKNOWN),pa=b("MWChatBlurTab.bs").useHook(b("MessengerWebEntryPoint").UNKNOWN);O=b("useCometConfirmationDialog")();var qa=O[0],ra=b("bs_curry")._1(b("MWUILeaveGroup.bs").useHook,0),sa=function(a){typeof z==="number"?b("recoverableViolation")("Trying to leave non-group thread","messenger_comet"):z[0]!==757211935?b("recoverableViolation")("Trying to leave non-group thread","messenger_comet"):b("bs_curry")._2(ra,z[1],a);return b("bs_curry")._1(Q,z)};b("MWChatTabGroupWarningPolicy.bs").useGroupEntranceWarningEffect(z,sa,function(a){return b("bs_curry")._1(Q,z)},function(a){return b("bs_curry")._1(na,z)});var ta=function(a){a=y.current;if(a==null)return 0;else return a.scrollToBottom()},ua=b("bs_curry")._1(b("MWUIUpdateParticipantNickname.bs").useHook,0),S=b("MWChatXmaThirdPartyActionHandler.bs").useHandler(0),va=b("MWChatPollXMAActionHandler.bs").useHandler(0),wa=b("bs_curry")._1(b("MWUISendTextMessage.bs").useSendTextMessage,0),xa=b("bs_curry")._1(b("MWUIDeleteThread.bs").useDeleteThread,0),ya=b("bs_curry")._1(b("MWUIWebUrlCtaHandler.bs").useShowWebViewDialog,0),za=b("bs_curry")._1(b("MWUISendCometPostback.bs").useSendCometPostback,0),Aa=b("bs_curry")._1(L,z),T=z[1],Ba=function(a){if(q>0&&x.current===0)return b("bs_curry")._1(l,0);else return 0};s=function(a){b("bs_curry")._1(l,0);return ta(0)};F=i.useCallback(function(a){if(Aa)return b("bs_curry")._3(qa,b("MWChatConfirmTabCloseDialog.bs").content,function(a){return b("bs_curry")._1(Q,z)},function(a){return 0});else return b("bs_curry")._1(Q,z)},[z,Aa,qa,Q]);P=i.useCallback(function(a){b("BanzaiODS").bumpEntityKey(3185,"mwchat_header","minimize");a=typeof z==="number"||z[0]!==757211935?null:z[1];b("MessengerWebStgTypedLoggerLite.bs").log({event_name:b("MessengerWebEvent").MINIMIZE_CHAT_TAB,other_user_fbid:b("bs_js_null_undefined").fromOption(A),thread_fbid:a});return b("bs_curry")._1(R,z)},[z,R]);o=i.useCallback(function(a){return b("bs_curry")._1(R,z)},[R,z]);M=function(d){if(typeof d==="number")if(d>=-303153203)if(d!==-299071693)if(d>=441686767)if(d>=1073450094){b("BanzaiODS").bumpEntityKey(3185,"mwchat_settings","delete_conv");b("bs_curry")._1(xa,z);return b("bs_curry")._1(Q,z)}else{Ba(0);return b("bs_curry")._1(oa,z)}else if(d>=-40606993)return b("bs_curry")._1(pa,z);else return b("bs_curry")._1(ea,function(a){return!a});else if(typeof z==="number")return b("unrecoverableViolation")("Attempted to call unsupported thread type","messenger_comet");else{var c=z[0];if(c!==757211935)if(c!==948354667)return b("unrecoverableViolation")("Attempted to call unsupported thread type","messenger_comet");else{b("ZenonUserActionLogger").logClick({component:b("bs_curry")._1(b("RTWebLoggingComponentConvert.bs").converter.toJS,1),surface:b("bs_curry")._1(b("RTWebLoggingSurfaceConvert.bs").converter.toJS,3)});return b("bs_curry")._3(v,!0,z[1],"comet_chattab_video_button")}else{b("ZenonUserActionLogger").logClick({component:b("bs_curry")._1(b("RTWebLoggingComponentConvert.bs").converter.toJS,1),surface:b("bs_curry")._1(b("RTWebLoggingSurfaceConvert.bs").converter.toJS,3)});return b("bs_curry")._3(v,!0,z[1],"comet_chattab_video_button")}}else if(d!==-1023538157)if(d>=-558830706)if(d>=-447262787)return ka(!0,0);else if(typeof z==="number")return b("unrecoverableViolation")("Attempted to call unsupported thread type","messenger_comet");else{c=z[0];if(c!==757211935)if(c!==948354667)return b("unrecoverableViolation")("Attempted to call unsupported thread type","messenger_comet");else{b("ZenonUserActionLogger").logClick({component:b("bs_curry")._1(b("RTWebLoggingComponentConvert.bs").converter.toJS,0),surface:b("bs_curry")._1(b("RTWebLoggingSurfaceConvert.bs").converter.toJS,3)});return b("bs_curry")._3(v,!1,z[1],"comet_chattab_audio_button")}else{b("ZenonUserActionLogger").logClick({component:b("bs_curry")._1(b("RTWebLoggingComponentConvert.bs").converter.toJS,0),surface:b("bs_curry")._1(b("RTWebLoggingSurfaceConvert.bs").converter.toJS,3)});return b("bs_curry")._3(v,!1,z[1],"comet_chattab_audio_button")}}else if(d>=-1006227213)return 0;else return ka(void 0,0);else return Ba(0);else{c=d[0];if(c>=-45085548)if(c>=501431055)if(c!==898208488)if(c>=501431056)return b("bs_curry")._1(S,d);else{var a=d[1];b("BanzaiODS").bumpEntityKey(3185,"mwchat_send","postback");return b("bs_curry")._2(za,a[0],a[1])}else{b("BanzaiODS").bumpEntityKey(3185,"mwchat_settings","leave_group");return sa(d[1])}else if(c>=91211743)if(c>=112234914)return b("bs_curry")._1(S,d);else{a=d[1];var e=a[1],f=a[0];b("BanzaiODS").bumpEntityKey(3185,"mwchat_settings","change_nickname");if(typeof z==="number")return 0;else{a=z[0];if(a!==757211935&&a!==948354667)return 0;var g=b("bs_curry")._2(ma,f,e);a=function(a){return 0};var h=function(a){b("bs_curry")._2(ma,f,g);return 0};return b("bs_curry")._5(ua,z[1],f,e,a,h)}}else if(c>=-20482460){e=d[1];a=e[1];if(z[0]!==757211935){h=z[1];if(e[0]){b("MWChatBlockMessagesMutation").commitBlock(h,a,function(a){return 0});return 0}else{b("MWChatBlockMessagesMutation").commitUnblock(h,a,function(a){return 0});return 0}}else return b("unrecoverableViolation")("Can't block a group or local thread","messenger_comet")}else{e=d[1];h=e[0];a=e[1];e=y.current;if(e==null)return 0;else return e.scrollToElement(h,a)}else if(c>=-341485885)if(c!==-268108250)if(c>=-122148607){b("bs_curry")._1(ea,function(a){return!a});return b("bs_curry")._1(da,d[1])}else return b("bs_curry")._1(S,d);else{e=d[1];return b("bs_curry")._2(va,e[0],e[1])}else if(c!==-611266716)if(c>=-445185539){b("BanzaiODS").bumpEntityKey(3185,"mwchat_send","reply");return b("bs_curry")._1(ia,d[1])}else return b("bs_curry")._1(S,d);else return b("bs_curry")._1(ya,d[1])}};O=i.jsx(b("MWUIInThreadBanner.bs").make,{});if(typeof z==="number"||z[0]!==892012143)L=[null,null];else{var U=z[1];if(H!==void 0){var V=b("bs_caml_option").valFromOption(H),W=V.icebreakers;W=W.length!==0&&n===!0?i.jsx(i.Suspense,{children:i.jsx(ba,aa(V.icebreakers,function(a){b("BanzaiODS").bumpEntityKey(3185,"mwchat_send","text");b("bs_curry")._4(wa,z,a,void 0,void 0);b("bs_curry")._1(l,0);return ta(0)},U,G,void 0,0)),fallback:i.jsx(b("CometProgressRingIndeterminate.react"),{color:"disabled",size:24})}):null}else W=null;L=[i.jsx(b("CometLazyDialogTrigger.react"),{dialogResource:b("JSResource")("MWChatBusinessManageMessagesDialogForJSResource.react").__setRef("MWChatTabContainer_DEPRECATED.bs"),dialogProps:{id:U,onClose:function(a){return 0},dispatch:M},children:function(a,c){return i.jsx(b("CometLink.react"),{role:"button",style:{display:"block",fontWeight:"bold",paddingLeft:"4px"},children:g._("G\u00e9rer les messages"),ref:c,onClick:function(c){return b("bs_curry")._1(a,0)}})}}),W]}V=L[1];U=L[0];W=b("bs_curry")._1(b("MWUIContactCapabilities.bs").useCapabilities,b("bs_caml_format").caml_int64_of_string(T));L=b("bs_curry")._1(b("MWUIContactCapabilities.bs").isVerified,W)?"BLUE_VERIFIED":void 0;W=typeof J==="number"||J.tag!==2?void 0:J[0].href;var Ca=function(a,c){var d=b("bs_curry")._1(b("MWUIGetServerMessageID.bs").getServerMessageID,a.message_id);if(c)return b("XCometMessengerPhotoControllerRouteBuilder").buildURL({photo_ids:a.photo_ids,fbid:a.fbid,message_id:d});else return b("XCometMessengerMediaControllerRouteBuilder").buildURL({thread_id:T,attachment_id:a.fbid,message_id:d})},X=i.useState(function(){return}),Y=X[1];X=X[0];var Da=i.useCallback(function(a){return b("bs_curry")._1(Y,function(a){return})},[Y]),Ea=i.useCallback(function(a){return b("bs_curry")._1(Y,function(b){return a})},[Y]),Z=b("qex")._("1586110");Z=Z==null?{}:{fontSize:String(Z)+"px"};var $;if(b("cr:1375301")==null)if(b("cr:1536325")==null)$=null;else{K={id:z,items:t,header:J,otherUserFbid:A,rtcButtonDisplayState:K,showSettings:p[0],showSpinner:w,isActiveNow:C,contextBannerData:I,welcomePageData:H,unreadCount:q,isBlocked:E,isMuted:r,isViewerInGroup:la,isTabFocused:c,isScrolledToBottomRef:x,scrollerRef:y,sheet:O,icebreakerUI:V,managePageMessagesLink:U,shouldShowMenu:u,composerType:N,dispatch:M,closeTab:F,minimizeTab:P,clickHeader:o,endFirstChatTabOpenLoggerRef:k,hasContent:d,participants:B,nicknames:fa,pageVerificationBadge:L,reportingToken:m,repliedToMessage:D,isEmptyThread:n,openPageURL:W,buildSharedMediaViewerURL:Ca,messageRequestInfoText:i.jsx(b("MWChatComposerMessageRequestInfoText.bs").make,{closeTab:Q}),closeReplyPreview:ha,onSendMessage:s};p=b("MWChatComposerViewStateStore.bs").get(z);p!==void 0&&(K.initialComposerViewState=b("bs_caml_option").valFromOption(p));C=ca[1];C!==void 0&&(K.ongoingCallType=b("bs_caml_option").valFromOption(C));$=i.jsx(b("cr:1536325").make,K)}else{I={items:t,id:z,searchResultMessages:j,otherUserFbid:A,showSpinner:w,welcomePageData:H,unreadCount:q,isTabFocused:c,isScrolledToBottomRef:x,scrollerRef:y,sheet:O,icebreakerUI:V,managePageMessagesLink:U,shouldShowMenu:u,composerType:N,dispatch:M,closeTab:F,endFirstChatTabOpenLoggerRef:k,hasContent:d,participants:B,nicknames:fa,repliedToMessage:D,buildSharedMediaViewerURL:Ca,closeReplyPreview:ha,onSendMessage:s};E=b("MWChatComposerViewStateStore.bs").get(z);E!==void 0&&(I.initialComposerViewState=b("bs_caml_option").valFromOption(E));$=i.jsx(b("cr:1375301").make,I)}return i.jsx(b("MWTheme.bs").provider,{theme:X!==void 0?X:ja,setTheme:Ea,clearTheme:Da,children:i.jsxs(b("CometTransientDialogProvider.react"),{children:[i.jsx(b("CometHeroHoldTrigger.react"),{description:"MWChatTab",hold:w||J===1}),i.jsx("div",{children:$,"aria-label":b("bs_belt_Option").mapWithDefault(G,g._("Chargement de la conversation"),function(a){return g._("Discuter avec {thread_title}",[g._param("thread_title",a)])}),className:(h||(h=b("stylex")))(b("CurrentUser").isWorkUser()?b("MWChatTabContainerShared.bs").styles.workChatTab:b("MWChatTabContainerShared.bs").styles.chatTab,f?b("MWChatTabContainerShared.bs").styles.sidebarChatOverrides:!1,e?b("MWChatTabContainerShared.bs").styles.chatTabNoBottomRadius:!1,b("qex")._("1586109")?b("MWChatTabContainerShared.bs").styles.chatTabThin:!1),role:a?"main":"region",style:Z},T)]})})}c=a;f.make=c}),null);